<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Private ¬∑ Zen Lab</title>
  <link rel="icon" href="assets/Logo.svg">
  <link rel="stylesheet" href="assets/style.css">
  <script defer src="assets/script.js"></script>
  <script src="https://unpkg.com/dropbox/dist/Dropbox-sdk.min.js"></script>
  <script defer src="assets/dropbox-auth.js"></script>
  <script defer src="assets/todo-manager.js"></script>
  <script defer src="assets/calendar-manager.js"></script>

  <style>
    .js-toDoList { list-style-type: none; padding-left: 0; }
    .js-toDoList button { font-size: 12px; padding: 2px 5px; background: transparent; border:none; cursor:pointer; }
    .rich-text-editor { width:100%; min-height:200px; border:1px solid #ccc; padding:10px; background:#f9f9f9; margin-top:20px; }
    .calendar-container { font-family:Arial,sans-serif; padding:20px; border-radius:8px; max-width:400px; margin:20px 0; background:#f0f0f0; }
    .calendar-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
    .calendar-header button { background:none; border:none; font-size:1.5em; cursor:pointer; }
    .calendar-days { display:grid; grid-template-columns:repeat(7,1fr); text-align:center; font-weight:bold; }
    .calendar-dates { display:grid; grid-template-columns:repeat(7,1fr); text-align:center; }
    .calendar-dates div { padding:10px; cursor:pointer; }
    .calendar-dates .selected-date { background:#007bff; color:#fff; border-radius:50%; }
    
    .auth-status { padding: 10px; margin: 10px 0; border-radius: 5px; font-weight: bold; }
    .auth-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .auth-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .auth-pending { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
    
    .btn { padding: 8px 16px; margin: 5px; cursor: pointer; border: none; border-radius: 4px; }
    .btn-primary { background: #007bff; color: white; }
    .btn-success { background: #28a745; color: white; }
    .btn-secondary { background: #6c757d; color: white; }
  </style>
</head>

<body>
    <nav class="nav">
        <a class="logo" href="index.html">Zen Lab</a>
        <input id="menu-toggle" type="checkbox">
        <label class="menu-button-container" for="menu-toggle">
            <span class="menu-button"></span>
        </label>
        <ul class="menu">
            <li><a href="news.html">üéâNews</a></li>
            <li><a href="research.html">Research</a></li>
            <li><a href="members.html">Members</a></li>
            <li><a href="publications.html">Publications</a></li>
            <li><a href="teaching.html">Teaching</a></li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
    </nav>

    <main class="private-wrap">
    <section id="app">
        
        <div id="auth-status" class="auth-status auth-pending">
            Dropbox Ïó∞Í≤∞ ÌôïÏù∏ Ï§ë...
        </div>
        
        <div id="auth-actions" style="margin-bottom: 20px;">
            <button id="connect-btn" class="btn btn-primary" style="display:none;">Dropbox Ïó∞Í≤∞</button>
            <button id="disconnect-btn" class="btn btn-secondary" style="display:none;">Ïó∞Í≤∞ Ìï¥Ï†ú</button>
        </div>

        <div class="Todo">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
               <h3 id="todo-list">Todo List - YYYY.MM.DD</h3> 
               <div>
                   <button class="btn btn-secondary" id="loadBtntd" style="display:none;">Î∂àÎü¨Ïò§Í∏∞</button>
                   <button class="btn btn-success" id="saveBtntd" style="display:none;">Ï†ÄÏû•</button>
               </div>
            </div>
            <form class="js-toDoForm">
                <input type="text" placeholder="Write a to do" />
                <button type="button" class="js-addBtn">Add</button>
            </form>
            <ul class="js-toDoList"></ul>
        </div>

        <div class="report-editor">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h3 id="report-title">Daily Report - YYYY.MM.DD</h3>
                <div>
                    <button class="btn btn-secondary" id="loadBtn" style="display:none;">Î∂àÎü¨Ïò§Í∏∞</button>
                    <button class="btn btn-success" id="saveBtn" style="display:none;">Ï†ÄÏû•</button>
                </div>
            </div>
            <div class="rich-text-editor" id="report-content" contenteditable="true">
              <p>Write your daily report here...</p>
            </div>
        </div>
        
        <div class="calendar-container">
            <div class="calendar-header">
                <button id="prev-month">‚Äπ</button>
                <h3 id="month-year"></h3>
                <button id="next-month">‚Ä∫</button>
                <button id="today-btn">Today</button>
            </div>
            <div class="calendar-days">
                <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div>
                <div>Thu</div><div>Fri</div><div>Sat</div>
            </div>
            <div class="calendar-dates" id="calendar-dates"></div>
        </div>
    </section>
    </main>
    
    <footer class="footer">
        <div>&copy; <span id="year"></span> Zen Lab. All rights reserved.</div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            await DropboxAuth.initialize();
            CalendarManager.checkAndResetIfNewDay();
            CalendarManager.setupMidnightReset();
            CalendarManager.goToToday();
            document.getElementById('year').textContent = new Date().getFullYear();
        });
    </script>
</body>
</html>